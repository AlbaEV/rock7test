SELECT COUNT(DISTINCT A.ID_TEAM), A.GPS_AT FROM POSITIONS A INNER JOIN POSITIONS B ON A.ID_TEAM <> B.ID_TEAM AND A.SOG_KMPH > 0 AND B.SOG_KMPH > 0 AND A.DTF_KM > 0 AND B.DTF_KM > 0 AND (B.GPS_AT_MILLIS BETWEEN A.GPS_AT_MILLIS -30000 AND A.GPS_AT_MILLIS +30000) AND (B.LONGITUDE BETWEEN A.LONGITUDE -0.05 AND A.LONGITUDE +0.05) AND (B.LATITUDE BETWEEN A.LATITUDE -0.05 AND A.LATITUDE +0.05) GROUP BY DAY(A.GPS_AT)